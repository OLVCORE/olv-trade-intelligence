# üì¶ SISTEMA DE CARDS EXPANS√çVEIS - DOCUMENTA√á√ÉO COMPLETA

> **Documenta√ß√£o completa para replicar o sistema de cards expans√≠veis de empresas em qualquer projeto**

---

## üéØ O QUE √â ESTE SISTEMA?

Um **sistema modular e reutiliz√°vel** de cards expans√≠veis que exibe informa√ß√µes detalhadas de empresas B2B, com:

‚úÖ **Interface Compacta:** Tabela principal mostra apenas informa√ß√µes essenciais  
‚úÖ **Expans√£o Inteligente:** Clique para revelar detalhes completos em card de 2 colunas  
‚úÖ **Auto-Enriquecimento:** Integra√ß√£o com Apollo.io para buscar decisores e dados automaticamente  
‚úÖ **100% Tipado:** TypeScript end-to-end para seguran√ßa e autocomplete  
‚úÖ **Performance:** Suporta 100+ empresas sem lag  
‚úÖ **Responsivo:** Funciona em desktop, tablet e mobile  

---

## üì∏ PREVIEW

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TABELA PRINCIPAL (Colapsada)                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [‚ñ∂] WellReformer | USA | sporting goods | 85 | Verificar | ...    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                              ‚¨áÔ∏è CLIQUE

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [‚ñº] WellReformer | USA | sporting goods | 85 | Verificar | ...    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ ‚îÇ üìã Informa√ß√µes Gerais        ‚îÇ üéØ Fit Score: 85             ‚îÇ  ‚îÇ
‚îÇ ‚îÇ üìç Localiza√ß√£o               ‚îÇ üåê Links Externos            ‚îÇ  ‚îÇ
‚îÇ ‚îÇ üìù Descri√ß√£o                 ‚îÇ üë• Decisores (5)             ‚îÇ  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìö ESTRUTURA DA DOCUMENTA√á√ÉO

### üìñ **3 Documentos Principais**

| Documento | Descri√ß√£o | Quando Usar |
|-----------|-----------|-------------|
| **[REPLICAR_CARD_EXPANSIVEL_COMPLETO.md](./REPLICAR_CARD_EXPANSIVEL_COMPLETO.md)** | üìò Guia completo de implementa√ß√£o (15+ p√°ginas) | Implementa√ß√£o inicial do zero |
| **[EXEMPLOS_PRATICOS_CARD_EXPANSIVEL.md](./EXEMPLOS_PRATICOS_CARD_EXPANSIVEL.md)** | üí° Casos de uso e personaliza√ß√µes | Adicionar features avan√ßadas |
| **[CHEATSHEET_CARD_EXPANSIVEL.md](./CHEATSHEET_CARD_EXPANSIVEL.md)** | ‚ö° Refer√™ncia r√°pida | Consulta durante desenvolvimento |

---

## üöÄ START R√ÅPIDO (5 MINUTOS)

### **Op√ß√£o A: Setup B√°sico (Sem Apollo)**

```bash
# 1. Executar SQL no Supabase
ALTER TABLE public.companies
  ADD COLUMN IF NOT EXISTS raw_data JSONB DEFAULT '{}'::jsonb;

# 2. Copiar componente
cp REPLICAR_CARD_EXPANSIVEL_COMPLETO.md componente.tsx

# 3. Testar
npm run dev
```

### **Op√ß√£o B: Setup Completo (Com Apollo)**

```bash
# 1. SQL + Edge Function + Componente
# Ver: REPLICAR_CARD_EXPANSIVEL_COMPLETO.md ‚Üí Se√ß√£o "PASSO A PASSO"

# 2. Configurar Apollo API Key
supabase secrets set APOLLO_API_KEY=your_key

# 3. Deploy
supabase functions deploy enrich-apollo-decisores --no-verify-jwt
```

---

## üéì ROADMAP DE APRENDIZADO

### **N√≠vel 1: Iniciante** (30 minutos)

```
1. Ler: REPLICAR_CARD_EXPANSIVEL_COMPLETO.md (Vis√£o Geral)
2. Executar: SQL b√°sico (adicionar raw_data)
3. Implementar: Hook useCompanies
4. Testar: Expans√£o de uma linha
```

### **N√≠vel 2: Intermedi√°rio** (2 horas)

```
1. Ler: REPLICAR_CARD_EXPANSIVEL_COMPLETO.md (Componentes)
2. Implementar: Card completo (2 colunas)
3. Adicionar: Links externos (Website, LinkedIn)
4. Testar: Card com dados reais
```

### **N√≠vel 3: Avan√ßado** (1 dia)

```
1. Ler: REPLICAR_CARD_EXPANSIVEL_COMPLETO.md (Edge Functions)
2. Implementar: enrich-apollo-decisores
3. Ler: EXEMPLOS_PRATICOS_CARD_EXPANSIVEL.md (Auto-Enriquecimento)
4. Testar: Enriquecimento autom√°tico de empresas
```

### **N√≠vel 4: Expert** (1 semana)

```
1. Ler: EXEMPLOS_PRATICOS_CARD_EXPANSIVEL.md (Integra√ß√µes)
2. Implementar: LinkedIn Sales Navigator
3. Implementar: Clearbit Enrichment
4. Otimizar: Virtualiza√ß√£o + Lazy Loading
5. Testar: 1000+ empresas
```

---

## üõ†Ô∏è STACK TECNOL√ìGICO

| Categoria | Tecnologia | Vers√£o | Obrigat√≥rio? |
|-----------|------------|--------|--------------|
| **Frontend** | React | 18+ | ‚úÖ Sim |
| | TypeScript | 5+ | ‚úÖ Sim |
| | shadcn/ui | - | ‚úÖ Sim |
| | Lucide Icons | - | ‚úÖ Sim |
| | React Query | 4+ | ‚úÖ Sim |
| **Backend** | Supabase | - | ‚úÖ Sim |
| | PostgreSQL | 14+ | ‚úÖ Sim |
| | Edge Functions (Deno) | - | ‚ö†Ô∏è Opcional |
| **APIs** | Apollo.io | - | ‚ö†Ô∏è Opcional |
| | LinkedIn Sales Nav | - | ‚ö†Ô∏è Opcional |
| | Clearbit | - | ‚ö†Ô∏è Opcional |

---

## üì¶ O QUE EST√Å INCLU√çDO?

### **1. Schema de Banco de Dados**

```sql
-- Tabela companies com raw_data (JSONB)
-- Tabela decision_makers com classifica√ß√£o autom√°tica
-- √çndices GIN para busca r√°pida em JSON
-- Triggers para auto-enriquecimento
```

### **2. Componentes React**

```typescript
// Hook useCompanies (React Query)
// P√°gina CompaniesManagementPage
// Card expans√≠vel (2 colunas)
// Renderiza√ß√£o condicional inteligente
```

### **3. Edge Functions**

```typescript
// enrich-apollo-decisores (Buscar decisores do Apollo)
// auto-enrich-on-create (Enriquecimento autom√°tico)
// Classifica√ß√£o de decisores por cargo (CEO, VP, Director)
```

### **4. TypeScript Types**

```typescript
// Interface Company completa
// Interface DecisionMaker
// Types para raw_data (JSONB)
```

### **5. Testes & Troubleshooting**

```typescript
// Testes de expans√£o
// Testes de Apollo enrichment
// Debugging de CORS, raw_data, etc.
```

---

## üéØ CASOS DE USO

### **Use Case 1: CRM B2B**

```
Problema: Tabela de leads com muitas colunas fica confusa
Solu√ß√£o: Card expans√≠vel mostra detalhes sob demanda
Resultado: Interface limpa, navega√ß√£o intuitiva
```

### **Use Case 2: Sales Intelligence**

```
Problema: Precisa enriquecer leads com dados do Apollo/LinkedIn
Solu√ß√£o: Integra√ß√£o autom√°tica via Edge Functions
Resultado: Decisores e descri√ß√£o aparecem automaticamente
```

### **Use Case 3: Dashboard de Monitoramento**

```
Problema: Acompanhar 100+ empresas em tempo real
Solu√ß√£o: Card com m√©tricas-chave (Fit Score, Status, etc.)
Resultado: Vis√£o geral + detalhes quando necess√°rio
```

---

## üèÜ MELHORES PR√ÅTICAS

### ‚úÖ DO (Fa√ßa)

```
‚úÖ Usar raw_data (JSONB) para dados flex√≠veis
‚úÖ Adicionar stopPropagation() em bot√µes dentro de linhas clic√°veis
‚úÖ Usar React Query para cache autom√°tico
‚úÖ Adicionar loading states e error handling
‚úÖ Testar em mobile antes de deploy
‚úÖ Validar dados antes de salvar em raw_data
```

### ‚ùå DON'T (N√£o Fa√ßa)

```
‚ùå Criar coluna SQL para cada campo novo (use raw_data)
‚ùå Esquecer headers CORS em Edge Functions
‚ùå Renderizar 1000+ linhas sem virtualiza√ß√£o
‚ùå Acessar raw_data sem fallback (use ?. e ||)
‚ùå Deixar dados fict√≠cios em produ√ß√£o
‚ùå Fazer ALTER TABLE em produ√ß√£o sem teste
```

---

## üîß TROUBLESHOOTING R√ÅPIDO

### Problema: "Empresas n√£o aparecem"

```typescript
// 1. Verificar query
console.log('Companies:', companies);

// 2. Verificar RLS (Supabase)
-- Disable RLS temporariamente para testar
ALTER TABLE companies DISABLE ROW LEVEL SECURITY;

// 3. Verificar filtros
const filteredCompanies = companies.filter(c => 
  console.log('Filtro:', c) || true
);
```

### Problema: "Card n√£o expande"

```typescript
// 1. Debug toggleRow
const toggleRow = (id: string) => {
  console.log('Toggle:', id, 'Current:', expandedRow);
  setExpandedRow(prev => prev === id ? null : id);
};

// 2. Verificar stopPropagation
<Button onClick={(e) => {
  e.stopPropagation(); // IMPORTANTE!
  toggleRow(id);
}}>
```

### Problema: "raw_data vazio"

```sql
-- 1. Verificar tipo
SELECT jsonb_typeof(raw_data) FROM companies LIMIT 1;

-- 2. Inicializar se NULL
UPDATE companies SET raw_data = '{}'::jsonb WHERE raw_data IS NULL;

-- 3. Merge seguro
UPDATE companies
SET raw_data = COALESCE(raw_data, '{}'::jsonb) || '{"new": "data"}'::jsonb;
```

**Mais troubleshooting:** Ver `CHEATSHEET_CARD_EXPANSIVEL.md`

---

## üìà ROADMAP FUTURO

### **v1.0** (Atual)

- [x] Card expans√≠vel b√°sico
- [x] Integra√ß√£o Apollo.io
- [x] Classifica√ß√£o de decisores
- [x] Documenta√ß√£o completa

### **v1.1** (Pr√≥ximo)

- [ ] Lazy loading de decisores
- [ ] Virtualiza√ß√£o para 1000+ empresas
- [ ] Exportar card para PDF
- [ ] Integra√ß√£o LinkedIn Sales Navigator

### **v1.2** (Futuro)

- [ ] Card com abas (Tabs)
- [ ] Busca inteligente com ranking
- [ ] Auto-enriquecimento em background (Trigger SQL)
- [ ] Integra√ß√£o Clearbit + Google Places

### **v2.0** (Vision)

- [ ] UI Builder (drag-and-drop para customizar card)
- [ ] Templates marketplace
- [ ] Analytics dashboard
- [ ] Multi-tenant SaaS

---

## ü§ù CONTRIBUINDO

### Como Adicionar um Novo Caso de Uso

1. Fork este projeto
2. Adicionar exemplo em `EXEMPLOS_PRATICOS_CARD_EXPANSIVEL.md`
3. Testar implementa√ß√£o
4. Criar Pull Request

### Como Reportar Bug

1. Verificar se j√° existe issue
2. Incluir:
   - Descri√ß√£o do problema
   - Passos para reproduzir
   - Logs do console
   - Vers√£o do React/TypeScript/Supabase

---

## üìû SUPORTE

### Canais de Suporte

| Canal | Resposta | Link |
|-------|----------|------|
| **Documenta√ß√£o** | Instant√¢nea | Este README |
| **Cheatsheet** | Instant√¢nea | `CHEATSHEET_CARD_EXPANSIVEL.md` |
| **GitHub Issues** | 1-2 dias | (adicionar link do repo) |
| **Email** | 3-5 dias | (adicionar email) |

### Perguntas Frequentes

**Q: Funciona com outros backends al√©m do Supabase?**  
A: Sim! Adapte o `useCompanies` hook para sua API REST/GraphQL.

**Q: Preciso usar Apollo.io?**  
A: N√£o. O card funciona sem Apollo, mas perde enriquecimento autom√°tico.

**Q: Funciona com React Native?**  
A: N√£o diretamente. Precisa adaptar componentes UI (shadcn/ui √© web-only).

**Q: Posso usar com Next.js?**  
A: Sim! Funciona com Next.js 13+ (App Router ou Pages Router).

---

## üìú LICEN√áA

MIT License - Use livremente em projetos comerciais e open-source.

---

## ‚úÖ PR√ìXIMOS PASSOS

### Para Iniciantes

```
1. Ler: README_CARD_EXPANSIVEL.md (este arquivo)
2. Ir para: REPLICAR_CARD_EXPANSIVEL_COMPLETO.md ‚Üí Se√ß√£o "Vis√£o Geral"
3. Executar: SQL b√°sico (5 minutos)
4. Testar: Expans√£o de uma linha
```

### Para Avan√ßados

```
1. Pular para: EXEMPLOS_PRATICOS_CARD_EXPANSIVEL.md
2. Escolher caso de uso (auto-enriquecimento, integra√ß√£o, etc.)
3. Implementar e testar
4. Contribuir com novo exemplo
```

---

## üéâ AGRADECIMENTOS

Este sistema foi desenvolvido no projeto **OLV Trade Intelligence** e est√° sendo compartilhado como open-source para a comunidade.

**Tecnologias usadas:**
- React + TypeScript (Frontend)
- Supabase (Backend)
- shadcn/ui (Componentes)
- Apollo.io (Enriquecimento)

**Inspira√ß√µes:**
- HubSpot CRM
- Salesforce Lightning
- Linear.app

---

## üìä ESTAT√çSTICAS

- **Linhas de C√≥digo:** ~2.000 linhas (frontend + backend)
- **Tempo de Implementa√ß√£o:** 2-4 horas (b√°sico) | 1-2 dias (completo)
- **Performance:** < 100ms para expandir card
- **Suporte:** 100+ empresas simultaneamente
- **Compatibilidade:** Chrome, Firefox, Safari, Edge
- **Mobile:** 100% responsivo

---

**üöÄ Bom desenvolvimento!**

---

**√öltima Atualiza√ß√£o:** 2025  
**Vers√£o da Documenta√ß√£o:** 1.0.0  
**Projeto:** OLV Trade Intelligence

